<div class="management-container">
  <!-- Header -->
  <header class="management-header">
    <div class="title-wrap">
      <h1>Quản lý Vai trò</h1>
      <span class="meta-pill">Tổng: {{ totalCount }}</span>
    </div>

    <a routerLink="new" class="btn btn-primary">
      <i class="fas fa-plus"></i>
      <span>Thêm mới</span>
    </a>
  </header>

  <!-- Loading -->
  <div *ngIf="isLoading" class="alert info">
    <i class="fas fa-spinner fa-spin"></i>
    <span>Đang tải dữ liệu…</span>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="alert danger">
    <i class="fas fa-triangle-exclamation"></i>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Table -->
  <div *ngIf="!isLoading && !errorMessage" class="table-card">
    <table class="table">
      <thead>
        <tr>
          <th>Mã vai trò</th>
          <th>Tên vai trò</th>
          <th>Mô tả</th>
          <th class="col-actions">Hành động</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let r of roles; trackBy: trackById">
          <td><span class="code">{{ r.roleId }}</span></td>

          <td class="name-cell">
            <span class="avatar">{{ (r.roleName || 'R')[0] | uppercase }}</span>
            <span class="name">{{ r.roleName }}</span>
          </td>

          <td>
            <span class="muted">{{ r.description || '—' }}</span>
          </td>

          <td class="col-actions">
            <div class="action-buttons">
              <a [routerLink]="['edit', r.roleId]" class="btn btn-secondary">
                <i class="fas fa-edit"></i>
                <span>Sửa</span>
              </a>
              <button (click)="deleteRole(r.roleId)" class="btn btn-danger">
                <i class="fas fa-trash-alt"></i>
                <span>Xóa</span>
              </button>
            </div>
          </td>
        </tr>

        <tr *ngIf="roles?.length === 0">
          <td colspan="4" class="empty">Không có dữ liệu vai trò để hiển thị.</td>
        </tr>
      </tbody>
    </table>

    <!-- Footer: phân trang -->
    <div class="table-footer">
      <div class="hint">
        Hiển thị
        {{ (totalCount === 0) ? 0 : ((currentPage - 1) * pageSize + 1) }}
        –
        {{ ((currentPage * pageSize) > totalCount) ? totalCount : (currentPage * pageSize) }}
        trong tổng số {{ totalCount }} vai trò
      </div>

      <div class="pager">
        <select class="page-size"
                [ngModel]="pageSize"
                (ngModelChange)="changePageSize(+$event)">
          <option [ngValue]="5">5 / trang</option>
          <option [ngValue]="10">10 / trang</option>
          <option [ngValue]="20">20 / trang</option>
          <option [ngValue]="50">50 / trang</option>
        </select>

        <button class="page-btn" (click)="prev()" [disabled]="currentPage === 1">&laquo;</button>
        <button class="page-btn"
                *ngFor="let p of pages"
                (click)="goToPage(p)"
                [class.is-active]="currentPage === p">
          {{ p }}
        </button>
        <button class="page-btn" (click)="next()" [disabled]="currentPage >= totalPages">&raquo;</button>
      </div>
    </div>
  </div>
</div>
