<div class="management-container">
  <!-- Header -->
  <header class="management-header">
    <div class="header-top">
      <h1>Quản lý Sinh viên</h1>

      <div class="top-right">
        <div class="stats">
          <span>Tổng: <strong>{{ totalCount }}</strong></span>
          <span class="sep"></span>
        </div>
        <a routerLink="new" class="btn btn-primary">
          <i class="fas fa-plus"></i>
          <span>Thêm mới</span>
        </a>
      </div>
    </div>
  </header>

  <!-- Loading -->
  <div *ngIf="isLoading" class="alert info">
    <i class="fas fa-spinner fa-spin"></i>
    <span>Đang tải dữ liệu…</span>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="alert danger">
    <i class="fas fa-triangle-exclamation"></i>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Table -->
  <div *ngIf="!isLoading && !errorMessage" class="table-card">
    <table class="table">
      <thead>
        <tr>
          <th class="col-id">Mã</th>
          <th>Tên đăng nhập</th>
          <th>Email</th>
          <th>Liên kết</th>
          <th>Trạng thái</th>
          <th class="col-actions">Hành động</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let s of students; trackBy: trackById">
          <td class="code">SV{{ s.studentId }}</td>

          <td class="name-cell">
            <span class="avatar">{{ (s.fullName || 'SV')[0] | uppercase }}</span>
            <div class="name-wrap">
              <div class="name">{{ s.fullName || '—' }}</div>
              <div class="sub">SV{{ s.studentId }}</div>
            </div>
          </td>

          <td>
            <a class="link" href="mailto:{{ s.email }}">{{ s.email || '—' }}</a>
          </td>

          <td>
            <span class="badge-soft">{{ s.classId || 'N/A' }}</span>
          </td>

          <td>
            <span class="status active">Hoạt động</span>
          </td>

          <td class="col-actions">
            <div class="action-buttons">
              <a [routerLink]="['edit', s.studentId]" class="chip chip-edit">Sửa</a>
              <button (click)="deleteStudent(s.studentId)" class="chip chip-delete" type="button">Xoá</button>
            </div>
          </td>
        </tr>

        <tr *ngIf="students?.length === 0">
          <td colspan="6" class="empty">Không có dữ liệu sinh viên để hiển thị.</td>
        </tr>
      </tbody>
    </table>

    <div class="table-footer">
      <div class="hint">
        Hiển thị
        {{ (currentPage - 1) * pageSize + (students.length ? 1 : 0) }}
        –
        {{ (currentPage - 1) * pageSize + students.length }}
        trong tổng số {{ totalCount }} sinh viên
      </div>

      <div class="pager">
        <!-- Chọn page size (client) -->
        <select class="page-size"
                [ngModel]="pageSize"
                (ngModelChange)="changePageSize($event)">
          <option [ngValue]="5">5 / trang</option>
          <option [ngValue]="10">10 / trang</option>
          <option [ngValue]="20">20 / trang</option>
          <option [ngValue]="50">50 / trang</option>
        </select>

        <button class="page-btn" (click)="prev()" [disabled]="currentPage === 1">&laquo;</button>

        <button class="page-btn"
                *ngFor="let p of pages"
                (click)="goToPage(p)"
                [class.is-active]="currentPage === p">
          {{ p }}
        </button>

        <button class="page-btn" (click)="next()" [disabled]="currentPage === totalPages">&raquo;</button>
      </div>
    </div>
  </div>
</div>
