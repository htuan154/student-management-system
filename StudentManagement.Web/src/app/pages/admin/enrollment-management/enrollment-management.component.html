<h2>Quản lý lượt đăng ký</h2>

<form (ngSubmit)="saveEnrollment()">
  <label>Student ID:</label>
  <input [(ngModel)]="formData.studentId" name="studentId" required />

  <label>Course ID:</label>
  <input [(ngModel)]="formData.courseId" name="courseId" required />

  <button type="submit">{{ editingId ? 'Cập nhật' : 'Thêm mới' }}</button>
  <button *ngIf="editingId" type="button" (click)="cancelEdit()">Hủy</button>
</form>

<hr />

<div>
  <input [(ngModel)]="searchTerm" placeholder="Tìm kiếm..." name="search" />
  <button (click)="search()">Tìm</button>
</div>

<div *ngIf="isLoading">Đang tải dữ liệu...</div>
<div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>

<table *ngIf="!isLoading && enrollments.length > 0" border="1">
  <thead>
    <tr>
      <th>ID</th>
      <th>Student ID</th>
      <th>Course ID</th>
      <th>Điểm (nếu có)</th>
      <th>Hành động</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let e of enrollments">
      <td>{{ e.enrollmentId }}</td>
      <td>{{ e.studentId }}</td>
      <td>{{ e.courseId }}</td>
      <td>{{ e.score ?? 'N/A' }}</td>
      <td>
        <button (click)="editEnrollment(e.enrollmentId)">Sửa</button>
        <button (click)="deleteEnrollment(e.enrollmentId)">Xóa</button>
      </td>
    </tr>
  </tbody>
</table>

<div *ngIf="totalCount > pageSize" class="pagination">
  <button (click)="pageChanged(currentPage - 1)" [disabled]="currentPage === 1">Trước</button>
  <span>Trang {{ currentPage }} / {{ totalPages }}</span>
  <button (click)="pageChanged(currentPage + 1)" [disabled]="currentPage === totalPages">Sau</button>
</div>
